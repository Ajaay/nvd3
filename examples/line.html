<!DOCTYPE html>
<meta charset="utf-8">
<link href="../src/d3.css" rel="stylesheet" type="text/css">
<style>

body {
  overflow-y:scroll;
}

#wrap {
  width: 960px;
}

.chartWrap {
  margin: 40px auto;
  border: 1px solid #999;
}

.code {
  margin: 0 20px;
}

#lineChart {
  width: 960px;
  height: 400px;
}




</style>
<body>

  <div id="wrap">
    <div id="lineChart" class="chartWrap">
      <svg></svg>
    </div>

    <div id="line-js" class="code">
      <pre class="brush: js; toolbar: false; gutter: false">
      </pre>
    </div>

  </div>


<script src="../lib/jquery.min.js"></script>

<script src="../js/libs/sh/shCore.js"></script>
<script src="../js/libs/sh/shBrushCss.js"></script>
<script src="../js/libs/sh/shBrushJScript.js"></script>
<script src="../js/libs/sh/shBrushXml.js"></script>


<script src="../lib/d3.v2.js"></script>
<script src="../nv.d3.js"></script>
<script src="../src/models/line.js"></script>
<script>



//Format A
nv.addGraph({
  generate: function() {
    var width = $('#lineChart').width(),
        height = $('#lineChart').height();

    var chart = nv.models.line()
                .width(width)
                .height(height)
                .margin({top: 20, right: 20, bottom: 20, left: 20})


    d3.select('#lineChart svg')
      .attr('width', width)
      .attr('height', height)
      .datum(sinAndCos())
      .call(chart);

    return chart;
  },
  callback: function(graph) {
    $(window).resize(function() {
      var width = $('#lineChart').width(),
          height = $('#lineChart').height(),
          margin = graph.margin();


      if (width < margin.left + margin.right + 20)
        width = margin.left + margin.right + 20;

      if (height < margin.top + margin.bottom + 20)
        height = margin.top + margin.bottom + 20;


      graph
         .width(width)
         .height(height);

      d3.select('#lineChart svg')
        .attr('width', width)
        .attr('height', height)
        .call(graph);
    });
  }
});



function sinAndCos() {
  var sin = [],
      cos = [];

  for (var i = 0; i < 100; i++) {
    sin.push({x: i, y: Math.sin(i/10)});
    cos.push({x: i, y: .5 * Math.cos(i/10)});
  }

  return [
    {
      values: sin,
      key: "Sine Wave",
      color: "#ff7f0e"
    },
    {
      values: cos,
      key: "Cosine Wave",
      color: "#2ca02c"
    }
  ];
}




$.ajax({
  url: '../src/models/line.js',
  type: 'GET',
  dataType: 'text',
  success: function(data) {
    $('#line-js pre').text(data);
    SyntaxHighlighter.highlight();
  }
});

</script>
